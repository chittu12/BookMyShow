{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Chittu\\\\Desktop\\\\bookmyshow frontend\\\\src\\\\pages\\\\Booking.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport api from '../api';\nimport SeatGrid from '../components/SeatGrid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Booking() {\n  _s();\n  const [shows, setShows] = useState([]);\n  const [selectedShow, setSelectedShow] = useState(null);\n  const [seats, setSeats] = useState([]);\n  const [selectedSeats, setSelectedSeats] = useState([]);\n  async function fetch() {\n    try {\n      const res = await api.get('/show');\n      setShows(res.data || []);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n  useEffect(() => {\n    fetch();\n  }, []);\n  async function loadSeats(show) {\n    setSelectedShow(show);\n    try {\n      const res = await api.get(`/showseat/show/${show.id}`); // try this endpoint\n      setSeats(res.data || []);\n      setSelectedSeats([]);\n    } catch (err) {\n      console.error(err);\n      setSeats([]);\n    }\n  }\n  function toggleSeat(seat) {\n    const exists = selectedSeats.find(s => s.id === seat.id);\n    if (exists) setSelectedSeats(selectedSeats.filter(s => s.id !== seat.id));else setSelectedSeats([...selectedSeats, seat]);\n  }\n  async function book() {\n    if (!selectedShow) return alert('Select show');\n    if (selectedSeats.length === 0) return alert('Select seats');\n    try {\n      const payload = {\n        show: {\n          id: selectedShow.id\n        },\n        seats: selectedSeats.map(s => ({\n          id: s.id\n        }))\n      };\n      await api.post('/booking/post', payload);\n      alert('Booking created');\n      loadSeats(selectedShow);\n    } catch (err) {\n      console.error(err);\n      alert('Booking failed');\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl mb-3\",\n      children: \"Booking\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"select\", {\n        onChange: e => {\n          const id = Number(e.target.value);\n          const s = shows.find(x => x.id === id);\n          if (s) loadSeats(s);\n        },\n        className: \"p-2 border rounded\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Select Show\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), shows.map(s => {\n          var _s$movie;\n          return /*#__PURE__*/_jsxDEV(\"option\", {\n            value: s.id,\n            children: [\"#\", s.id, \" - \", ((_s$movie = s.movie) === null || _s$movie === void 0 ? void 0 : _s$movie.title) || s.movie]\n          }, s.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 26\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), selectedShow && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-4 rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-semibold mb-2\",\n        children: [\"Seats for show #\", selectedShow.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SeatGrid, {\n        seats: seats,\n        onToggle: toggleSeat\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: book,\n          className: \"px-3 py-1 bg-indigo-600 text-white rounded\",\n          children: [\"Book (\", selectedSeats.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s(Booking, \"0BOmunB0vJ2hcmGVq2BWet70uAg=\");\n_c = Booking;\nvar _c;\n$RefreshReg$(_c, \"Booking\");","map":{"version":3,"names":["React","useEffect","useState","api","SeatGrid","jsxDEV","_jsxDEV","Booking","_s","shows","setShows","selectedShow","setSelectedShow","seats","setSeats","selectedSeats","setSelectedSeats","fetch","res","get","data","err","console","error","loadSeats","show","id","toggleSeat","seat","exists","find","s","filter","book","alert","length","payload","map","post","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","Number","target","value","x","_s$movie","movie","title","onToggle","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Chittu/Desktop/bookmyshow frontend/src/pages/Booking.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport api from '../api'\r\nimport SeatGrid from '../components/SeatGrid'\r\n\r\nexport default function Booking(){\r\n  const [shows, setShows] = useState([])\r\n  const [selectedShow, setSelectedShow] = useState(null)\r\n  const [seats, setSeats] = useState([])\r\n  const [selectedSeats, setSelectedSeats] = useState([])\r\n\r\n  async function fetch(){\r\n    try{\r\n      const res = await api.get('/show')\r\n      setShows(res.data || [])\r\n    }catch(err){ console.error(err) }\r\n  }\r\n\r\n  useEffect(()=>{ fetch() }, [])\r\n\r\n  async function loadSeats(show){\r\n    setSelectedShow(show)\r\n    try{\r\n      const res = await api.get(`/showseat/show/${show.id}`) // try this endpoint\r\n      setSeats(res.data || [])\r\n      setSelectedSeats([])\r\n    }catch(err){\r\n      console.error(err)\r\n      setSeats([])\r\n    }\r\n  }\r\n\r\n  function toggleSeat(seat){\r\n    const exists = selectedSeats.find(s=>s.id===seat.id)\r\n    if (exists) setSelectedSeats(selectedSeats.filter(s=>s.id!==seat.id))\r\n    else setSelectedSeats([...selectedSeats, seat])\r\n  }\r\n\r\n  async function book(){\r\n    if (!selectedShow) return alert('Select show')\r\n    if (selectedSeats.length===0) return alert('Select seats')\r\n    try{\r\n      const payload = {\r\n        show: { id: selectedShow.id },\r\n        seats: selectedSeats.map(s=>({ id: s.id }))\r\n      }\r\n      await api.post('/booking/post', payload)\r\n      alert('Booking created')\r\n      loadSeats(selectedShow)\r\n    }catch(err){ console.error(err); alert('Booking failed') }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl mb-3\">Booking</h2>\r\n      <div className=\"mb-4\">\r\n        <select onChange={e=>{\r\n          const id = Number(e.target.value)\r\n          const s = shows.find(x=>x.id===id)\r\n          if (s) loadSeats(s)\r\n        }} className=\"p-2 border rounded\">\r\n          <option value=\"\">Select Show</option>\r\n          {shows.map(s=> <option key={s.id} value={s.id}>#{s.id} - {s.movie?.title || s.movie}</option>)}\r\n        </select>\r\n      </div>\r\n\r\n      {selectedShow && (\r\n        <div className=\"bg-white p-4 rounded shadow\">\r\n          <h3 className=\"font-semibold mb-2\">Seats for show #{selectedShow.id}</h3>\r\n          <SeatGrid seats={seats} onToggle={toggleSeat} />\r\n          <div className=\"mt-3\">\r\n            <button onClick={book} className=\"px-3 py-1 bg-indigo-600 text-white rounded\">Book ({selectedSeats.length})</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}